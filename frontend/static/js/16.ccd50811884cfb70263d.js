webpackJsonp([16],{e1PV:function(t,e){},riuE:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("CCn6"),i=a("JF9t"),l=a("zL8q"),r={props:{step_two_info:{type:Object,default:function(){}},step_one_info:{type:Object,default:function(){}}},components:{AreaTitle:function(){return a.e(19).then(a.bind(null,"it6S"))},Dialog:function(){return a.e(0).then(a.bind(null,"9q6c"))}},data:function(){return{page_size:10,current_page:1,null_page_size:10,null_current_page:1,show_null_flag:!1,null_rate_table_data:[],null_rate_index_list:[],loading:!1,click_name:"",edit_flag:!1,inner_fee:"",loading_create_task:!1}},methods:{handle_size_change:function(t){!0===this.show_null_flag?this.null_page_size=t:this.page_size=t},handle_current_change:function(t){!0===this.show_null_flag?this.null_current_page=size:this.current_page=t},show_null_rate:function(){var t=this;this.null_rate_table_data=this.rate_table_data.filter(function(e){return""!==e.plan_in_rate&&""!==e.plan_out_rate&&""!==e.rate_threshold||t.null_rate_index_list.push(e.case_id),""===e.plan_in_rate||""===e.plan_out_rate||""===e.rate_threshold}),this.show_null_flag=!0,this.null_rate_index_list.forEach(function(e){for(var a=0;a<t.rate_table_data.length;a++)t.rate_table_data[a].case_id===e&&t.rate_table_data.splice(a,1)}),this.null_rate_index_list=[]},handle_flush:function(){this.rate_table_data=this.null_rate_table_data.concat(this.rate_table_data),this.show_null_flag=!1,this.null_rate_table_data=[],this.handle_current_change(1)},add_unit:function(){for(var t=0;t<this.rate_table_data.length;t++)"voice"===this.rate_table_data[t].serv_type?(this.rate_table_data[t].serv_type="语音",this.rate_table_data[t].showUnit="分钟",this.rate_table_data[t].showUnit_rate="厘/分钟"):"data"===this.rate_table_data[t].serv_type?(this.rate_table_data[t].serv_type="流量",this.rate_table_data[t].showUnit="KB",this.rate_table_data[t].showUnit_rate="厘/KB"):"sms"===this.rate_table_data[t].serv_type&&(this.rate_table_data[t].serv_type="短信",this.rate_table_data[t].showUnit="条",this.rate_table_data[t].showUnit_rate="厘/条")},edit:function(t){switch(t){case"1":this.click_name="套内免费资源";break;case"2":this.click_name="套内费率";break;case"3":this.click_name="套外费率"}this.inner_fee="",this.edit_flag=!0},pl_ok:function(){if(!0===this.show_null_flag)for(var t=0;t<this.null_rate_table_data.length;t++)"套内免费资源"===this.click_name?this.null_rate_table_data[t].rate_threshold=this.inner_fee:"套内费率"===this.click_name?this.null_rate_table_data[t].plan_in_rate=this.inner_fee:"套外费率"===this.click_name&&(this.null_rate_table_data[t].plan_out_rate=this.inner_fee);else for(var e=0;e<this.rate_table_data.length;e++)"套内免费资源"===this.click_name?this.rate_table_data[e].rate_threshold=this.inner_fee:"套内费率"===this.click_name?this.rate_table_data[e].plan_in_rate=this.inner_fee:"套外费率"===this.click_name&&(this.rate_table_data[e].plan_out_rate=this.inner_fee);this.inner_fee="",this.edit_flag=!1},update_rate:function(){var t=this;this.handle_flush();for(var e=0;e<this.rate_table_data.length;e++){if(""===this.rate_table_data[e].plan_in_rate||null===this.rate_table_data[e].plan_in_rate||void 0===this.rate_table_data[e].plan_in_rate)return this.$message.warning("套内费率存在空值，请筛选出空值并修改！"),!1;if(""===this.rate_table_data[e].plan_out_rate||null===this.rate_table_data[e].plan_out_rate||void 0===this.rate_table_data[e].plan_out_rate)return this.$message.warning("套外费率存在空值，请筛选出空值并修改！"),!1;if(""===this.rate_table_data[e].rate_threshold||null===this.rate_table_data[e].rate_threshold||void 0===this.rate_table_data[e].rate_threshold)return this.$message.warning("套内免费源存在空值，请筛选出空值并修改！"),!1}this.loading=!0;var a={test_list:this.rate_table_data};n.a.config_manage_api.update_case_rate(a).then(function(e){t.loading=!1,0===e.status?t.create_test_task():t.$message.error("系统异常，请联系管理员！")})},create_test_task:function(){var t=this,e=l.Loading.service({fullscreen:!0}),a=[];this.rate_table_data.forEach(function(t){a.push(t.case_id)});var r={user_id:Object(i.a)("user_id"),case_id_list:a,offer_id:this.require_info.form.fee_code,test_numbers:this.require_info.instance_info.test_numbers};n.a.whole_test_api.whl_create_instance(r).then(function(a){if(0===a.status){var n={};n.instance_id=a.info.instance_id,t.$emit("next_step","step_three",n)}else t.$message.error("生成测试任务失败，请联系系统管理员！");e.close()})}},computed:{rate_table_data:{get:function(){return this.step_two_info.rate_info},set:function(t){this.step_two_info.rate_info=t}},require_info:function(){return this.step_one_info}},mounted:function(){this.add_unit()}},_={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"steq_panel_form",staticStyle:{"padding-bottom":"108px"}},[a("AreaTitle",{attrs:{title:"编辑费率"}}),t._v(" "),a("div",{staticClass:"tr mgt-25"},[a("el-button",{staticStyle:{background:"none"},attrs:{type:"primary",plain:"",size:"small"},on:{click:t.handle_flush}},[t._v("刷新")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.show_null_rate}},[t._v("空值")])],1),t._v(" "),a("div",{staticClass:"table"},[t.show_null_flag?a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"selection",staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.null_rate_table_data.slice((t.null_current_page-1)*t.null_page_size,t.null_current_page*t.null_page_size),border:"","element-loading-text":"跳转中，请稍等。。。","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[a("el-table-column",{attrs:{prop:"case_name",label:"测试用例名称","show-overflow-tooltip":!0,align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"serv_type",label:"业务类型",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"visit_county",label:"漫游国家代码",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"other_party_head",label:"拨打对端国家",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"rate_threshold",label:"套内免费资源",align:"center"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("span",[t._v("套内免费资源")]),t._v(" "),a("br"),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.edit("1")}}},[t._v("批量编辑")])]}},{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"100px !important"},attrs:{clearable:"",size:"mini"},model:{value:e.row.rate_threshold,callback:function(a){t.$set(e.row,"rate_threshold",a)},expression:"scope.row.rate_threshold"}}),t._v(" "),a("span",{staticStyle:{display:"inline-block","line-height":"31px","font-size":"12px"}},[t._v(t._s(e.row.date)+t._s(e.row.showUnit))])]}}],null,!1,4049363166)}),t._v(" "),a("el-table-column",{attrs:{prop:"plan_in_rate",label:"套内费率",align:"center"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("span",[t._v("套内费率")]),t._v(" "),a("br"),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.edit("2")}}},[t._v("批量编辑")])]}},{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"100px !important"},attrs:{clearable:"",size:"mini"},model:{value:e.row.plan_in_rate,callback:function(a){t.$set(e.row,"plan_in_rate",a)},expression:"scope.row.plan_in_rate"}}),t._v(" "),a("span",{staticStyle:{display:"inline-block","line-height":"31px","font-size":"12px"}},[t._v(t._s(e.row.date)+t._s(e.row.showUnit_rate))])]}}],null,!1,1930244953)}),t._v(" "),a("el-table-column",{attrs:{prop:"plan_out_rate",label:"套外费率",align:"center"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("span",[t._v("套外费率")]),t._v(" "),a("br"),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.edit("3")}}},[t._v("批量编辑")])]}},{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"100px !important"},attrs:{clearable:"",size:"mini"},model:{value:e.row.plan_out_rate,callback:function(a){t.$set(e.row,"plan_out_rate",a)},expression:"scope.row.plan_out_rate"}}),t._v(" "),a("span",{staticStyle:{display:"inline-block","line-height":"31px","font-size":"12px"}},[t._v(t._s(e.row.date)+t._s(e.row.showUnit_rate))])]}}],null,!1,4182251906)})],1),t._v(" "),a("div",{staticClass:"search_pagination"},[a("el-pagination",{attrs:{"current-page":t.null_current_page,"page-sizes":[5,10,15],"page-size":t.null_page_size,layout:"sizes, prev, pager, next",total:t.null_rate_table_data.length},on:{"size-change":t.handle_size_change,"current-change":t.handle_current_change,"update:currentPage":function(e){t.null_current_page=e},"update:current-page":function(e){t.null_current_page=e}}})],1)],1):a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"selection",staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.rate_table_data.slice((t.current_page-1)*t.page_size,t.current_page*t.page_size),border:"","element-loading-text":"跳转中，请稍等。。。","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[a("el-table-column",{attrs:{prop:"case_name",label:"测试用例名称","show-overflow-tooltip":!0,align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"serv_type",label:"业务类型",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"visit_county",label:"漫游国家代码",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"other_party_head",label:"拨打对端国家",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"rate_threshold",label:"套内免费资源",align:"center"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("span",[t._v("套内免费资源")]),t._v(" "),a("br"),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.edit("1")}}},[t._v("批量编辑")])]}},{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"100px !important"},attrs:{clearable:"",size:"mini"},model:{value:e.row.rate_threshold,callback:function(a){t.$set(e.row,"rate_threshold",a)},expression:"scope.row.rate_threshold"}}),t._v(" "),a("span",{staticStyle:{display:"inline-block","line-height":"31px","font-size":"12px"}},[t._v(t._s(e.row.date)+t._s(e.row.showUnit))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"plan_in_rate",label:"套内费率",align:"center"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("span",[t._v("套内费率")]),t._v(" "),a("br"),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.edit("2")}}},[t._v("批量编辑")])]}},{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"100px !important"},attrs:{clearable:"",size:"mini"},model:{value:e.row.plan_in_rate,callback:function(a){t.$set(e.row,"plan_in_rate",a)},expression:"scope.row.plan_in_rate"}}),t._v(" "),a("span",{staticStyle:{display:"inline-block","line-height":"31px","font-size":"12px"}},[t._v(t._s(e.row.date)+t._s(e.row.showUnit_rate))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"plan_out_rate",label:"套外费率",align:"center"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("span",[t._v("套外费率")]),t._v(" "),a("br"),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.edit("3")}}},[t._v("批量编辑")])]}},{key:"default",fn:function(e){return[a("el-input",{staticStyle:{width:"100px !important"},attrs:{clearable:"",size:"mini"},model:{value:e.row.plan_out_rate,callback:function(a){t.$set(e.row,"plan_out_rate",a)},expression:"scope.row.plan_out_rate"}}),t._v(" "),a("span",{staticStyle:{display:"inline-block","line-height":"31px","font-size":"12px"}},[t._v(t._s(e.row.date)+t._s(e.row.showUnit_rate))])]}}])})],1),t._v(" "),a("div",{staticClass:"search_pagination"},[a("el-pagination",{attrs:{"current-page":t.current_page,"page-sizes":[5,10,15],"page-size":t.page_size,layout:"sizes, prev, pager, next",total:t.rate_table_data.length},on:{"size-change":t.handle_size_change,"current-change":t.handle_current_change,"update:currentPage":function(e){t.current_page=e},"update:current-page":function(e){t.current_page=e}}})],1)],1)]),t._v(" "),a("Dialog",{attrs:{visible:t.edit_flag,width:"640",title:"批量修改"+t.click_name},on:{"update:visible":function(e){t.edit_flag=e},closeDialog:function(e){t.edit_flag=!1}}},[a("div",{attrs:{slot:"con"},slot:"con"},[t._v("\n      "+t._s(t.click_name)+":\n      "),a("el-input",{staticStyle:{width:"225px"},attrs:{placeholder:"请输入内容",clearable:""},model:{value:t.inner_fee,callback:function(e){t.inner_fee=e},expression:"inner_fee"}})],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"dialog__footer"},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.edit_flag=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.pl_ok}},[t._v("确认")])],1)])])],1)},staticRenderFns:[]};var s=a("VU/8")(r,_,!1,function(t){a("e1PV")},"data-v-078ffb69",null);e.default=s.exports}});
//# sourceMappingURL=16.ccd50811884cfb70263d.js.map